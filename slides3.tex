\documentclass[handout]{beamer}

%\usepackage{pgfpages}
%%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=right}

\setbeamertemplate{caption}[numbered]

\usepackage{tikz}
\usetikzlibrary{calc, matrix, arrows, automata, shapes, positioning, shadows, trees}
\usepackage{graphicx}
\usepackage{multimedia}
\usepackage[latin1]{inputenc}
\usecolortheme{lily}
\setbeamercovered{transparent}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{color}
\usepackage{subfigure}

\tikzset{basic/.style={draw}}
\tikzset{input/.style={basic, circle}}
\tikzset{bias/.style={basic, rectangle}}
\tikzset{neuron/.style={basic, circle}}
\tikzset{>=stealth, font=\scriptsize}
\tikzset{sectors/.style n args={2}{%
     circle, draw, minimum width=3.444em,
     append after command={%
         \pgfextra{ %
            \draw (\tikzlastnode.north) -- (\tikzlastnode.south);
            \path (\tikzlastnode.center) -- node[] {#1} (\tikzlastnode.west);
            \path (\tikzlastnode.center) -- node[] {#2} (\tikzlastnode.east);
         }
      }
   }
}

% argmax
\newcommand{\argmax}[1]{\underset{#1}{\operatorname{arg}\,\operatorname{max}}\;}
% argmin
\newcommand{\argmin}[1]{\underset{#1}{\operatorname{arg}\,\operatorname{min}}\;}

\title[\insertdate]{Binary Classification Using (tensor) LDA}

\author{Awais Bajwa,\\ Shinho Kang,\\ Omar Guti\'errez}
%\institute{@trinogz}
\date{\today}

\begin{document}

\begin{frame}
\titlepage
\end{frame}
\note{}

\begin{frame}
    \frametitle{Outline} 
    \tableofcontents
\end{frame}
\note{}

\section{Linear Discriminant Analysis}
\begin{frame}{Linear Discriminant Analysis}
    \begin{itemize}
        \item \textbf{Task}: Implement a binary classifier for car detection.
        \item Using (conventional) Linear Discriminant Analysis.
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Steps}
    \begin{itemize}
        \item Calculate mean $\mu$
            \begin{itemize}
                \item For class 0, class 1, and for the overall dataset
            \end{itemize}
        \item Calculate covariance matrix
            \begin{itemize}
                \item $S_B$ and $S_W$
            \end{itemize}
        \item Calculate projector matrix $w$
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Determine $w$}
    \begin{itemize}
        \item $w$ is a projection vector that maximally separates the data
    \end{itemize}
\Huge{
\begin{equation}
    \textcolor{red}{w} = 
    \textcolor{gray}{\argmax{w}}
    \frac{\textcolor{brown}{w^TS_Bw}}
    {\textcolor{blue}{w^TS_ww}}
\end{equation}
}
\end{frame}

\begin{frame}{Determine a projector $w$}
    \Huge
    \begin{equation}
        y(X) = \left\{
                    \begin{tabular}{cc}
                        $+1$, & if $w^{T}x \geq \theta$ \\
                        $-1$, & otherwise
                    \end{tabular}
                \right.
    \end{equation}
\end{frame}

\begin{frame}{Plot from $S_W$}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/s_w.png}
        \caption{Plot from $S_W$}
    \end{figure}
    }
\end{frame}

\begin{frame}{Plot from $S_B$}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/s_b.png}
        \caption{Plot from $S_B$}
    \end{figure}
    }
\end{frame}

%\begin{frame}{Plot from $w$}
%    {\centering
%    \begin{figure}[H]
%        \includegraphics[width=0.75\textwidth]{project_03/ww.png}
%        \caption{Plot from $w$}
%    \end{figure}
%    }
%\end{frame}

\begin{frame}{Plot from $w$}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/ww.png}
        \caption{Plot from $w$}
    \end{figure}
    }
\end{frame}

\begin{frame}{Plot from $w$}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/W.png}
        \caption{Plot from $w$}
    \end{figure}
    }
\end{frame}

%\begin{frame}{Result}
%    {\centering
%    \begin{figure}[H]
%        \includegraphics[width=0.75\textwidth]{project_03/lda.png}
%        \caption{Result from LDA}
%    \end{figure}
%    }
%\end{frame}

\begin{frame}{Result}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/lda_final.png}
        \caption{Result from LDA}
    \end{figure}
    }
\end{frame}

%\begin{frame}{Result}
%    {\centering
%    \begin{figure}[H]
%        \includegraphics[width=0.75\textwidth]{project_03/lda2.png}
%        \caption{Result from LDA}
%    \end{figure}
%    }
%\end{frame}

\begin{frame}{Benchmarking}
    \begin{itemize}
        \item $S_W$ duration: 140.9035672799946
        \item $S_B$ duration 0.48717122300877236
        \item $W$ duration 50.67935458800639
        \item Prediction duration: 0.0007773570105200633
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Precision and recall}
\Huge
\begin{equation}
    Precision = \frac{tp}{tp + fp}
\end{equation}
\begin{equation}
    Recall = \frac{tp}{tp + fn}
\end{equation}
\end{frame}

\begin{frame}{Precision and recall}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/precision.png}
        \caption{Precision and recall}
    \end{figure}
    }
\end{frame}

\section{Tensor Linear Discriminant Analysis}
\begin{frame}{Tensor Linear Discriminant Analysis}
    \begin{itemize}
        \item \textbf{Task}: Implement a binary classifier for car detection.
        \item Using this time Tensor Linear Discriminant Analysis.
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Tensor LDA properties}
    \begin{itemize}
        \item Treat images as images not as vectors
        \item Loss information when images are flattened
        \item Fast learning
        \item Handles small sample size problem
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Steps}
    \begin{itemize}
        \item Read data
        \item Initialize vector $u$, and $v$
        \item Compute contractions $u$, and $v$ for all images until difference is less than $\epsilon$
            \begin{itemize}
                \item $v(t) = \argmin{v} ||Xv-y||^2$ 
                \item $u(t) = \argmin{u} ||Xu-y||^2$ 
                \item $u$ and $v$ are kept orthogonal using Gram-Schmidt procedure
            \end{itemize}
        \item Compute $W$
            \begin{itemize}
                \item $W = u_1v^T_1 + ... + u_\rho v_\rho^T$ 
            \end{itemize}
        \item Evaluate multiple classifiers on the training data
        \item Use best classifier fot test data
    \end{itemize}
\end{frame}
\note{}

\begin{frame}{Tensor $w$}
    {\centering
    \begin{figure}[H]
        %\includegraphics[width=0.50\textwidth]{project_03/WUnique.png}
        \includegraphics[width=0.50\textwidth]{project_03/tensor_w.png}
        \caption{Plot from $w$ in Tensor LDA}
    \end{figure}
    }
\end{frame}

\begin{frame}{Tensor $w$}
    {\centering
    \begin{figure}[H]
        %\includegraphics[width=0.50\textwidth]{project_03/WUnique.png}
        \includegraphics[width=0.50\textwidth]{project_03/tensor_W.png}
        \caption{Plot from $w$ in Tensor LDA}
    \end{figure}
    }
\end{frame}

\begin{frame}{Tensor $w$}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.50\textwidth]{project_03/WUnique.png}
        \caption{Plot for $w$ in Tensor LDA}
    \end{figure}
    }
\end{frame}

\begin{frame}{Precision and recall}
    {\centering
    \begin{figure}[H]
        \includegraphics[width=0.75\textwidth]{project_03/tensor_precision_recall.png}
        \caption{Precision and recall}
    \end{figure}
    }
\end{frame}

\begin{frame}{Benchmarking}
    \begin{itemize}
        \item Compute contraction duration: 26.600847046996932
        \item Evaluation duration: 4.858664466999471
        \item Prediction duration: 0.0010174380004173145
    \end{itemize}
\end{frame}
\note{}

\end{document}
